<div class="form-group">
  <fieldset class="bg-light rounded border p-3" id="geolocFieldset">
    <legend class="w-auto bg-marta text-white border rounded p-1">geolocalizzazione generica</legend>
    <div class="form-row mb-3">
      <div class="col-md-3">
        <label for="comune">Comune</label>
        <select class="form-control form-control-sm tab" data-table="geolocalizzazione" id="comune" name="comune">
          <option value="">-- seleziona Comune --</option>
          <?php
          foreach($comuniPuglia as $c){
            echo "<option value='".$c['id']."'>".$c['comune']."</option>";
          }
          ?>
        </select>
      </div>
      <div class="col-md-7">
        <label for="via">Via</label>
        <div class="input-group input-group-sm mb-3">
          <input type="text" class="form-control tab" data-table="geolocalizzazione" name="via" id="via" value="" placeholder="cerca una via" disabled>
          <button class="btn btn-secondary btn-sm" type="button" id="cercaVia" name="cercaVia" disabled><i class="fa-solid fa-magnifying-glass"></i></button>
          <button class="btn btn-secondary btn-sm" type="button" id="resetVia" name="resetVia"><i class="fa-solid fa-trash-can"></i></button>
        </div>
        <div class="list-group" id="osmList"></div>
      </div>
    </div>
    <div class="form-row mb-3">
      <div class="col-md-5">
        <label for="geonote">Note geolocalizzazione</label>
        <textarea class="form-control form-control-sm tab" data-table="geolocalizzazione" id="geonote" name="geonote" rows="8"></textarea>
      </div>
      <div class="col-md-7">
        <small class="text-muted"><i class="fas fa-lightbulb" aria-hidden="true"></i> Nelle situazioni in cui non è posibile compilare la sezione "GP-Georeferenziazione tramite punto" a causa dell'assenza di dati precisi, si può indicare in alternativa una localizzazione generica, specificando il comune ed eventualmente la via.<br>Per inserire la via bisogna prima selezionare un Comune dalla lista<br>La ricerca della via avviene tramite il servizio messo a disposizione da OpenStreetMap (Nominatim), una volta inserito il nome premere sul pulsante accanto alla casella di input e scegliere la via dalla lista che comparirà<br/>La via potrebbe non essere presente nel database di OpenStreetMap, in tal caso basta inserire solo il Comune especificare il nome della via nel campo note.</small>
      </div>
    </div>
    <div class="form-row">
      <div class="col">
        <div id="osmFieldset">
          <input type="hidden" class="form-control form-control-sm" name="osm_id" data-table='vie' value="">
          <input type="hidden" class="form-control form-control-sm" id="comune_vie" name="comune" data-table='vie' value="">
          <input type="hidden" value='' class="form-control form-control-sm" name="via" id="osm_via" data-table='vie' value="">
          <input type="hidden" value='' class="form-control form-control-sm" name="lat" data-table='vie' value="">
          <input type="hidden" value='' class="form-control form-control-sm" name="lon" data-table='vie' value="">
        </div>
      </div>
    </div>
  </fieldset>
</div>

<div class="form-group">
  <fieldset class="bg-light rounded border p-3" id="gpFieldset">
    <legend class="w-auto bg-marta text-white border rounded p-1">gp - georeferenziazione tramite punto</legend>
    <div class="form-row mb-3">
      <div class="col">
        <div class="custom-control custom-checkbox">
          <input type="checkbox" class="custom-control-input" id="toggleGP" name="toggleSection" data-fieldset="gpFieldset">
          <label class="custom-control-label" for="toggleGP"><?php echo $gpCheckLabel; ?></label>
        </div>
      </div>
    </div>
    <div class="form-row">
      <div class="col-md-6">
        <div class="row mb-3">
          <div class="col-md-6">
            <label for="gpl" class="font-weight-bold obbligatorio <?php echo $gpLabelClass; ?>">GPL - Tipo di localizzazione</label>
            <select class="form-control form-control-sm tab obbligatorio" data-table="gp" id="gpl" name="gpl" <?php echo $gpRequired; ?>>
              <?php echo join("",$gplList); ?>
            </select>
          </div>
          <div class="col-md-6">
            <label for="gpp" class="font-weight-bold obbligatorio <?php echo $gpLabelClass; ?>">GPP - Sistema di riferimento</label>
            <select class="form-control form-control-sm tab obbligatorio" data-table="gp" id="gpp" name="gpp" <?php echo $gpRequired; ?>>
              <?php echo join("",$gppList); ?>
            </select>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-6">
            <label for="gpm" class="font-weight-bold obbligatorio <?php echo $gpLabelClass; ?>">GPM - Metodo</label>
            <select class="form-control form-control-sm tab obbligatorio" data-table="gp" id="gpm" name="gpm" <?php echo $gpRequired; ?>>
              <?php echo join("",$gpmList); ?>
            </select>
          </div>
          <div class="col-md-6">
            <label for="gpt" class="font-weight-bold obbligatorio <?php echo $gpLabelClass; ?>">GPT - Tecnica</label>
            <select class="form-control form-control-sm tab obbligatorio" data-table="gp" id="gpt" name="gpt" <?php echo $gpRequired; ?>>
              <?php echo join("",$gptList); ?>
            </select>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col-md-4">
            <label for="gpdpx" class="font-weight-bold obbligatorio <?php echo $gpLabelClass; ?>">GPDPX-Long</label>
            <input type="number" class="form-control form-control-sm tab obbligatorio" data-table="gp" id="gpdpx" name="gpdpx" min="0.0000" max="2222222222.9999" step="0.0001" value="<?php echo $scheda['gp']['gpdpx']; ?>"  <?php echo $gpRequired; ?>>
          </div>
          <div class="col-md-4">
            <label for="gpdpy" class="font-weight-bold obbligatorio <?php echo $gpLabelClass; ?>">GPDPY-Lat</label>
            <input type="number" class="form-control form-control-sm tab obbligatorio" data-table="gp" id="gpdpy" name="gpdpy" min="0.0000" max="9999999.9999" step="0.0001" value="<?php echo $scheda['gp']['gpdpy']; ?>"  <?php echo $gpRequired; ?>>
          </div>
          <div class="col-md-4">
            <label for="gpbt" data-toggle="tooltip" data-placement="top" title="inserire solo l'anno" class="font-weight-bold obbligatorio <?php echo $gpLabelClass; ?>"><i class="fas fa-info-circle"></i> GPBT - Data</label>
            <input type="number" placeholder="-- <?php echo date('Y'); ?> --" class="form-control form-control-sm tab obbligatorio"  data-table="gp" id="gpbt" name="gpbt" min="1945" max="<?php echo date('Y'); ?>" step="1" value="<?php echo $scheda['gp']['gpbt']; ?>"  <?php echo $gpRequired; ?>>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col">
            <label for="gpbb" class="font-weight-bold obbligatorio <?php echo $gpLabelClass; ?>">GPBB - Descrizione sintetica</label>
            <textarea class="form-control form-control-sm tab obbligatorio" data-table="gp" id="gpbb" name="gpbb" rows="4" <?php echo $gpRequired; ?>><?php echo $scheda['gp']['gpbb']; ?></textarea>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div id="mapCover"></div>
        <div id="gpMap"></div>
      </div>
    </div>
    <div class="form-row">
      <div class="col">
        <small class="text-muted"><i class="fas fa-lightbulb"></i> Se non riesci a localizzare il punto tramite dati d'archivio o cartografia nota, puoi utilizzare il tool grafico: abilita la sezione e inizia a navigare nella mappa in alto a destra, una volta individuato, clicca sul punto, i campi della sezione verranno automaticamente compilati con le coordinate rilevate sulla mappa e con alcuni valori di default. Tutti i valori inseriti automaticamente dal sistema possono essere modificati. Basta cliccare su un altro punto della mappa per modificare le coordinate.<br />Per annullare i dati immessi basta disattivare e riattivare la sezione cliccando sulla checkbox "Compila dati sezione"</small>
      </div>
    </div>
  </fieldset>
</div>
